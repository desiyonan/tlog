{
    "root": {
        "data": {
            "id": "cf97s9qs1s00",
            "created": 1635238825494,
            "text": "volatile"
        },
        "children": [
            {
                "data": {
                    "id": "cf995makir40",
                    "created": 1635242692656,
                    "text": "1. 具体含义作用",
                    "expandState": "collapse"
                },
                "children": [
                    {
                        "data": {
                            "id": "cfa0om7ophc0",
                            "created": 1635320351368,
                            "text": "含义",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa0ov36dgg0",
                                    "created": 1635320370688,
                                    "text": "线程之间共享可见的变量"
                                },
                                "children": []
                            }
                        ]
                    },
                    {
                        "data": {
                            "id": "cfa0p76vfns0",
                            "created": 1635320397032,
                            "text": "作用",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa0p8br2s80",
                                    "created": 1635320399503,
                                    "text": "1. 保证变量在线程间的可见性"
                                },
                                "children": []
                            },
                            {
                                "data": {
                                    "id": "cfa0psnc33c0",
                                    "created": 1635320443739,
                                    "text": "2. 对该变量的访问禁用指令重排"
                                },
                                "children": []
                            }
                        ]
                    }
                ]
            },
            {
                "data": {
                    "id": "cf995v2of2w0",
                    "created": 1635242711770,
                    "text": "2. 并发编程概念",
                    "expandState": "collapse"
                },
                "children": [
                    {
                        "data": {
                            "id": "cfa0qcn7vmo0",
                            "created": 1635320487268,
                            "text": "原子性",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa0x1sjenk0",
                                    "created": 1635321012194,
                                    "text": "一个操作或者多个操作 要么全部执行并且执行的过程不会被任何因素打断，要么就都不执行"
                                },
                                "children": []
                            },
                            {
                                "data": {
                                    "id": "cfa0x4eyck80",
                                    "created": 1635321017903,
                                    "text": "例子",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfa0x6wvps00",
                                            "created": 1635321023341,
                                            "text": "x = 10"
                                        },
                                        "children": []
                                    },
                                    {
                                        "data": {
                                            "id": "cfa0x9nnk5k0",
                                            "created": 1635321029313,
                                            "text": "x++"
                                        },
                                        "children": []
                                    },
                                    {
                                        "data": {
                                            "id": "cfa0xavw8680",
                                            "created": 1635321031988,
                                            "text": "x=x+2"
                                        },
                                        "children": []
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "data": {
                            "id": "cfa0qjwd67c0",
                            "created": 1635320503059,
                            "text": "可见性",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa0wt5ltmg0",
                                    "created": 1635320993393,
                                    "text": "多个线程访问同一个变量时，一个线程修改了这个变量的值，其他线程能够立即看得到修改的值"
                                },
                                "children": []
                            }
                        ]
                    },
                    {
                        "data": {
                            "id": "cfa0qm00wdc0",
                            "created": 1635320507633,
                            "text": "有序性",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa0y7wbnlc0",
                                    "created": 1635321103848,
                                    "text": "程序执行的顺序按照代码的先后顺序执行"
                                },
                                "children": []
                            },
                            {
                                "data": {
                                    "id": "cfa0ydq49540",
                                    "created": 1635321116533,
                                    "text": "指令重排",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfa0yipbso00",
                                            "created": 1635321127369,
                                            "text": "单线程不影响，多线程有问题"
                                        },
                                        "children": []
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "data": {
                    "id": "cf9t8evs3so0",
                    "created": 1635299333815,
                    "text": "3. 物理硬件架构",
                    "expandState": "collapse"
                },
                "children": [
                    {
                        "data": {
                            "id": "cfa12lqj85c0",
                            "created": 1635321447429,
                            "text": "图例",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa1058g5tc0",
                                    "created": 1635321254779,
                                    "text": "简单图示",
                                    "image": "https://oss.dnfn.tech:1024/bedroom/2021/10/27/20211027155639.jpeg",
                                    "imageTitle": "计算机硬件架构",
                                    "imageSize": {
                                        "width": 200,
                                        "height": 176
                                    }
                                },
                                "children": []
                            },
                            {
                                "data": {
                                    "id": "cfau48oe30g0",
                                    "created": 1635403387917,
                                    "text": "图例2",
                                    "image": "https://oss.dnfn.tech:1024/bedroom/2021/10/28/20211028144650.png",
                                    "imageTitle": "CPU内存屏障",
                                    "imageSize": {
                                        "width": 200,
                                        "height": 177
                                    }
                                },
                                "children": []
                            }
                        ]
                    },
                    {
                        "data": {
                            "id": "cfa12wmnb0g0",
                            "created": 1635321471139,
                            "text": "概念",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfa13k9369k0",
                                    "created": 1635321522562,
                                    "text": "主存 - 内存"
                                },
                                "children": []
                            },
                            {
                                "data": {
                                    "id": "cfa192rci880",
                                    "created": 1635321954669,
                                    "text": "CPU高速缓存",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfa1cjrellc0",
                                            "created": 1635322226770,
                                            "text": "意义",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfa1cn3dxow0",
                                                    "created": 1635322234025,
                                                    "text": "CPU运行速度和内存读写速度差异过大，引入三级缓存防止频繁读取内存影响运行速度"
                                                },
                                                "children": []
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfa14okxkfk0",
                                            "created": 1635321610349,
                                            "text": "组成",
                                            "expandState": "collapse",
                                            "note": null
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfa16bri4sg0",
                                                    "created": 1635321739177,
                                                    "text": "L1",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfa1go3mckw0",
                                                            "created": 1635322549673,
                                                            "text": "组成",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfa1f0pg3fk0",
                                                                    "created": 1635322420385,
                                                                    "text": "L1i"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfa1f5wfops0",
                                                                            "created": 1635322431692,
                                                                            "text": "一级指令缓存"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfa1f3grxs80",
                                                                    "created": 1635322426391,
                                                                    "text": "L1d"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfa1fav2e080",
                                                                            "created": 1635322442493,
                                                                            "text": "一级数据缓存"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfa1gsj6elc0",
                                                            "created": 1635322559320,
                                                            "text": "最近，最小，最快"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfa1ha3ucz40",
                                                            "created": 1635322597575,
                                                            "text": "核专属"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfa1l17uecg0",
                                                                    "created": 1635322891683,
                                                                    "text": "一个核独享一个一级缓存"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfa16dbawug0",
                                                    "created": 1635321742551,
                                                    "text": "L2",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfa1fdn9qfc0",
                                                            "created": 1635322448552,
                                                            "text": "二级缓存"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfa1iuhvgb40",
                                                            "created": 1635322720323,
                                                            "text": "核专属"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfa1lcsa25k0",
                                                                    "created": 1635322916863,
                                                                    "text": "一个核独享一个二级缓存"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfa16et29xc0",
                                                    "created": 1635321745802,
                                                    "text": "L3",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfa1ffvqcyo0",
                                                            "created": 1635322453417,
                                                            "text": "三级缓存"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfa1llo7zig0",
                                                            "created": 1635322936209,
                                                            "text": "座专属",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfa1lyh6c2w0",
                                                                    "created": 1635322964081,
                                                                    "text": "一个CPU座(多核)共享一个三级缓存"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfa1ca7s9w00",
                                            "created": 1635322205993,
                                            "text": "大小",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfa1cbn4ui80",
                                                    "created": 1635322209098,
                                                    "text": "lscpu查看"
                                                },
                                                "children": []
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "data": {
                                    "id": "cfa1mj39hao0",
                                    "created": 1635323008952,
                                    "text": "CPU缓存行",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfa1ml8kjwg0",
                                            "created": 1635323013627,
                                            "text": "定义",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfa21imgcy80",
                                                    "created": 1635324183398,
                                                    "text": "CPU缓存的基本单位"
                                                },
                                                "children": []
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfa21p7befs0",
                                            "created": 1635324197720,
                                            "text": "大小",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfa225fj7h40",
                                                    "created": 1635324233046,
                                                    "text": "2的整数幂个连续字节，一般为32-256个字节"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfa21qffrog0",
                                                    "created": 1635324200389,
                                                    "text": "常见为64字节"
                                                },
                                                "children": []
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfa22qpzcq80",
                                            "created": 1635324279390,
                                            "text": "作用",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfa22vgxbc00",
                                                    "created": 1635324289726,
                                                    "text": "缓存内存空间中连续的一段数据"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfa23bwwzd40",
                                                    "created": 1635324325522,
                                                    "text": "数组将缓存其后相邻的元素",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfa27mg6emg0",
                                                            "created": 1635324661911,
                                                            "text": "加快顺序访问"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfa23uwqsjc0",
                                                    "created": 1635324366870,
                                                    "text": "字段将缓存相邻的几个字段",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfa24o2yg6g0",
                                                            "created": 1635324430372,
                                                            "text": "伪共享",
                                                            "hyperlink": "https://www.jianshu.com/p/e338b550850f",
                                                            "hyperlinkTitle": "伪共享问题"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "data": {
                                    "id": "cfauqi1mqrs0",
                                    "created": 1635405132321,
                                    "text": "Store Buffer",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfauvzyiplk0",
                                            "created": 1635405563135,
                                            "text": "CPU核心与CPU缓存之间的一个存储缓冲"
                                        },
                                        "children": []
                                    },
                                    {
                                        "data": {
                                            "id": "cfautsycacw0",
                                            "created": 1635405391159,
                                            "text": "作用",
                                            "expandState": "expand"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfauwtb0zko0",
                                                    "created": 1635405627018,
                                                    "text": "目的是为了提升本CPU效率，将同步变异步"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfauuog3na80",
                                                    "created": 1635405459713,
                                                    "text": "将写非本CPU的独享变量与同步通知其他CPU把缓存置为无效的过程通过异步处理",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfb60boosds0",
                                                            "created": 1635436934328,
                                                            "text": "1. 当前CPU修改不是自己的独享变量"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfb60v0g02g0",
                                                            "created": 1635436976398,
                                                            "text": "2.1 写入本CPU的Store Buffer"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfb61j90jyo0",
                                                            "created": 1635437029159,
                                                            "text": "2.2 通知其他CPU设置无效缓存行"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfb620afjco0",
                                                            "created": 1635437066250,
                                                            "text": "3. 获得响应ACK"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfb62fimoag0",
                                                            "created": 1635437099397,
                                                            "text": "4. 将Store Buffer中的对应数据写入Cache"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfawpnyb44o0",
                                            "created": 1635410709036,
                                            "text": "副作用",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfawpt1mz0g0",
                                                    "created": 1635410720121,
                                                    "text": "单个CPU内的指令乱序",
                                                    "expandState": "expand"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfawvfkmkwo0",
                                                            "created": 1635411160979,
                                                            "text": "现象",
                                                            "expandState": "expand"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfawvt7buns0",
                                                                    "created": 1635411190650,
                                                                    "text": "本CPU修改其他CPU的独享变量后，马上读取还是原来的值（有延迟，好比和后续代码顺序调换）"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfb6dkbsgf40",
                                                                    "created": 1635437971873,
                                                                    "text": "图例",
                                                                    "image": "https://oss.dnfn.tech:1024/bedroom/2021/10/29/202110290020380.png",
                                                                    "imageTitle": "",
                                                                    "imageSize": {
                                                                        "width": 200,
                                                                        "height": 135
                                                                    }
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfb63coqdqw0",
                                                            "created": 1635437171600,
                                                            "text": "原因",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfb63iutbeg0",
                                                                    "created": 1635437185028,
                                                                    "text": "最开始的设计：（对非本CPU的独享变量）写操作先缓存至Store Buffer，读从直接从相应CPU那获取；写入Store Buffer与写入Cache是有延迟的（通知与等待ACK）"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfawwisik0w0",
                                                            "created": 1635411246351,
                                                            "text": "解决",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfawwkom8ig0",
                                                                    "created": 1635411250469,
                                                                    "text": "Store Forwarding",
                                                                    "font-weight": "bold",
                                                                    "expandState": "expand"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfawwnrniyg0",
                                                                            "created": 1635411257183,
                                                                            "text": "直接从Store Buffer读取已修改的缓存数据"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfax55c9wqg0",
                                                    "created": 1635411922348,
                                                    "text": "多个CPU之间变量的不正确同步"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfaxat9qe1s0",
                                                            "created": 1635412366258,
                                                            "text": "现象",
                                                            "expandState": "expand"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfaxhn408f40",
                                                                    "created": 1635412901400,
                                                                    "text": "几个变量在一个CPU里的有执行的顺序关系，但是在另一个CPU里这种关系却不成立"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfaxa2jlozc0",
                                                                    "created": 1635412308082,
                                                                    "text": "时序图",
                                                                    "expandState": "expand"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfaxa7wr0og0",
                                                                            "created": 1635412319761,
                                                                            "text": "图例",
                                                                            "image": "https://oss.dnfn.tech:1024/bedroom/2021/10/28/20211028171146.png",
                                                                            "imageTitle": "图",
                                                                            "imageSize": {
                                                                                "width": 200,
                                                                                "height": 162
                                                                            },
                                                                            "hyperlink": "https://zhuanlan.zhihu.com/p/125549632",
                                                                            "hyperlinkTitle": ""
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfaxawe3yk00",
                                                            "created": 1635412373053,
                                                            "text": "原因",
                                                            "expandState": "expand"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfaxbunst9k0",
                                                                    "created": 1635412447650,
                                                                    "text": "其他CPU修改某CPU的独享变量需要发送请求，但是是异步的，修改自身的独享变量是直接操作Cache"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfaxolzegb40",
                                                                    "created": 1635413447494,
                                                                    "text": "读取其他CPU的独享变量是通信同步的，所以是正确的"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfaxpowhq5c0",
                                                                    "created": 1635413532213,
                                                                    "text": "读取自身CPU的独享变量可以直接从Cache获取",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfaxq5eal4g0",
                                                                            "created": 1635413568118,
                                                                            "text": "读取都是同步顺序的，但如果发生变量被其他CPU修改，当前CPU的缓存行状态变化可能就会不及时"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfbiber275s0",
                                                            "created": 1635471656326,
                                                            "text": "解决",
                                                            "expandState": "expand"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfbibhwosk80",
                                                                    "created": 1635471663197,
                                                                    "text": "内存屏障"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "data": {
                                    "id": "cfauqj5iwfs0",
                                    "created": 1635405134733,
                                    "text": "Invalid Queue"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfauygxaxnk0",
                                            "created": 1635405756795,
                                            "text": "一个队列，用于存储其他CPU向当前CPU发出的请求，置某些缓存行为无效的消息"
                                        },
                                        "children": []
                                    },
                                    {
                                        "data": {
                                            "id": "cfav1rxori00",
                                            "created": 1635406015856,
                                            "text": "作用"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfav2vnfdo80",
                                                    "created": 1635406102307,
                                                    "text": "目的是为了提升其他CPU效率"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfav2l4xr1k0",
                                                    "created": 1635406079421,
                                                    "text": "加快响应其他CPU发出的置缓存行为无效的请求"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfav5k81k0o0",
                                                            "created": 1635406312524,
                                                            "text": "直接返回ACK"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfav5of8bb40",
                                                            "created": 1635406321666,
                                                            "text": "将消息放入队列中，后续处理"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfav5xheb2g0",
                                                                    "created": 1635406341388,
                                                                    "text": "处理时机：处理任何缓存行的MSEI状态前"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfbigxyovpc0",
                                                                    "created": 1635472089967,
                                                                    "text": "遗漏：本CPU的独享变量读取"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbih65wu9s0",
                                                                            "created": 1635472107818,
                                                                            "text": "使用读屏障解决",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfbikz99vzs0",
                                                                                    "created": 1635472406241,
                                                                                    "text": "遇到读屏障会把队列的消息处理了，然后处理屏障后的操作"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "data": {
                            "id": "cfaq9viybts0",
                            "created": 1635392545036,
                            "text": "影响",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfat13fmsyo0",
                                    "created": 1635400320301,
                                    "text": "缓存一致性",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfau939v36g0",
                                            "created": 1635403767976,
                                            "text": "CPU缓存加快数据的访问数据，但是多线程下对共享变量的读写将会存在延时，影响可见性"
                                        },
                                        "children": []
                                    }
                                ]
                            },
                            {
                                "data": {
                                    "id": "cfaqa4w7mls0",
                                    "created": 1635392565428,
                                    "text": "指令重排",
                                    "expandState": "expand"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfaqaifwj4o0",
                                            "created": 1635392594917,
                                            "text": "为了提升CPU的运行速度，但破坏了指令的有序性"
                                        },
                                        "children": []
                                    },
                                    {
                                        "data": {
                                            "id": "cfauk6yxu4g0",
                                            "created": 1635404638028,
                                            "text": "分类",
                                            "expandState": "expand"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfauk8j4zaw0",
                                                    "created": 1635404641426,
                                                    "text": "主动的",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfbi7lb00o00",
                                                            "created": 1635471357136,
                                                            "text": "编译器优化，使得CPU更快执行指令"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfbi77a1vs80",
                                                    "created": 1635471326604,
                                                    "text": "被动的",
                                                    "expandState": "expand"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfaukcteoio0",
                                                            "created": 1635404650754,
                                                            "text": "CPU流水线操作延迟。为了异步化指令的执行，引入Store Buffer和Invalidate Queue，却导致了「指令顺序改变」的副作用"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "data": {
                            "id": "cfauah76fs80",
                            "created": 1635403876653,
                            "text": "处理",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfauht8jf8g0",
                                    "created": 1635404451405,
                                    "text": "缓存一致性协议",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfauamfxpaw0",
                                            "created": 1635403888066,
                                            "text": "分类",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfauc88gcso0",
                                                    "created": 1635404013867,
                                                    "text": "MESI",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfauatf2zio0",
                                                            "created": 1635403903252,
                                                            "text": "状态",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfaubcji93c0",
                                                                    "created": 1635403944878,
                                                                    "text": "M",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfaubhde3340",
                                                                            "created": 1635403955392,
                                                                            "text": "修改",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfaudl2yhow0",
                                                                                    "created": 1635404120197,
                                                                                    "text": "该缓存行有效，数据被修改了，和内存中的数据不一致，数据只存在于本缓存行中"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfaubdlye1c0",
                                                                    "created": 1635403947203,
                                                                    "text": "E",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfaubvvim5s0",
                                                                            "created": 1635403986963,
                                                                            "text": "独享",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfaud71i6wo0",
                                                                                    "created": 1635404089634,
                                                                                    "text": "该缓存行有效，数据和内存中的数据一致，数据只存在于本缓存行中"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfaubeivk200",
                                                                    "created": 1635403949194,
                                                                    "text": "S",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfauby9hzuw0",
                                                                            "created": 1635403992162,
                                                                            "text": "共享",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfaud13w2mo0",
                                                                                    "created": 1635404076718,
                                                                                    "text": "该缓存行有效，数据和内存中的数据一致，数据同时存在于其他缓存中"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfaubfft3q00",
                                                                    "created": 1635403951185,
                                                                    "text": "I",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfauc0rid6o0",
                                                                            "created": 1635403997605,
                                                                            "text": "无效",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfauctoe4rs0",
                                                                                    "created": 1635404060543,
                                                                                    "text": "该缓存行数据无效"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfaue82knsw0",
                                                            "created": 1635404170240,
                                                            "text": "转换",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfauf3kbgew0",
                                                                    "created": 1635404238793,
                                                                    "text": "图例",
                                                                    "image": "https://oss.dnfn.tech:1024/bedroom/2021/10/28/20211028145709.png",
                                                                    "imageTitle": "MESI协议-状态转换",
                                                                    "imageSize": {
                                                                        "width": 200,
                                                                        "height": 136
                                                                    },
                                                                    "hyperlink": "https://www.jianshu.com/p/a4358d39adac",
                                                                    "hyperlinkTitle": ""
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfaub4s9t480",
                                                    "created": 1635403927994,
                                                    "text": "MSI"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfaub6r4dzs0",
                                                    "created": 1635403932278,
                                                    "text": "MOSI"
                                                },
                                                "children": []
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfbj7c4gvmg0",
                                            "created": 1635474158260,
                                            "text": "目的",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfbj7mpuygw0",
                                                    "created": 1635474181321,
                                                    "text": "解决多个CPU之间缓存不可见的问题"
                                                },
                                                "children": []
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfaui5ehqjc0",
                                            "created": 1635404477888,
                                            "text": "副作用",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfaui8vzj9s0",
                                                    "created": 1635404485475,
                                                    "text": "CPU性能降低",
                                                    "expandState": "expand"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfauim5ryb40",
                                                            "created": 1635404514365,
                                                            "text": "需要与其他CPU通信，通知响应和请求数据"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfaulpchcco0",
                                                    "created": 1635404756393,
                                                    "text": "指令乱序",
                                                    "expandState": "expand"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfaulxpmrso0",
                                                            "created": 1635404774603,
                                                            "text": "原因：为了提升CPU的运行，引入异步通信（Store Buffer&Invalid Queue），处理缓存有延迟"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfaumh8gmgw0",
                                                            "created": 1635404817100,
                                                            "text": "解决：提供内存屏障解决"
                                                        },
                                                        "children": []
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                ]
                            },
                            {
                                "data": {
                                    "id": "cfaup8cfi000",
                                    "created": 1635405032842,
                                    "text": "内存屏障",
                                    "expandState": "collapse"
                                },
                                "children": [
                                    {
                                        "data": {
                                            "id": "cfbo7hnvxls0",
                                            "created": 1635488275868,
                                            "text": "乱序现象"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfbo7m9ncxs0",
                                                    "created": 1635488285891,
                                                    "text": "Load-Store"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfbo86e4pow0",
                                                    "created": 1635488329698,
                                                    "text": "Store-Load"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfbo8ag0cs80",
                                                    "created": 1635488338518,
                                                    "text": "Load-Load"
                                                },
                                                "children": []
                                            },
                                            {
                                                "data": {
                                                    "id": "cfbo8dgpwj40",
                                                    "created": 1635488345091,
                                                    "text": "Store-Store"
                                                },
                                                "children": []
                                            }
                                        ]
                                    },
                                    {
                                        "data": {
                                            "id": "cfbjbesnltc0",
                                            "created": 1635474477533,
                                            "text": "分类",
                                            "expandState": "collapse"
                                        },
                                        "children": [
                                            {
                                                "data": {
                                                    "id": "cfbjbgzpaw80",
                                                    "created": 1635474482312,
                                                    "text": "写屏障",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfbogwr8km80",
                                                            "created": 1635489013999,
                                                            "text": "分类",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfboh0se4eg0",
                                                                    "created": 1635489022776,
                                                                    "text": "简单刷入，等待刷入完再继续执行，即变为同步",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbonwaprj40",
                                                                            "created": 1635489561550,
                                                                            "text": "一步一步完成，完成一个指令再执行下一行指令"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfboja6oqxs0",
                                                                    "created": 1635489199960,
                                                                    "text": "还是异步，把屏障后的操作也暂时缓存，一起刷入",
                                                                    "expandState": "collapse"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbjcpd2gxc0",
                                                                            "created": 1635474578899,
                                                                            "text": "写屏障后的写操作也跟同(写屏障标记的操作)写入Store Buffer中先缓冲，\n使得其他CPU想获取当前CPU的独享变量只能获取Cache中之前的值， \n直到当前CPU在适当时机（不太清楚，应该是获得ACK），才会把写屏障标记及之后的数据一同写入Cache"
                                                                        },
                                                                        "children": []
                                                                    },
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbjo9vnm5s0",
                                                                            "created": 1635475485564,
                                                                            "text": "实现写的可见性，写数据顺序的可见性",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfbk6cf1www0",
                                                                                    "created": 1635476901646,
                                                                                    "text": "1. 写远程缓存数据"
                                                                                },
                                                                                "children": []
                                                                            },
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfbk6k3sbvc0",
                                                                                    "created": 1635476918379,
                                                                                    "text": "2. 写本地缓存数据"
                                                                                },
                                                                                "children": [
                                                                                    {
                                                                                        "data": {
                                                                                            "id": "cfbkcevbwjs0",
                                                                                            "created": 1635477377169,
                                                                                            "text": "写屏障后的本地写操作"
                                                                                        },
                                                                                        "children": []
                                                                                    }
                                                                                ]
                                                                            },
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfbk6r2268g0",
                                                                                    "created": 1635476933512,
                                                                                    "text": "3. 获取到远程响应"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    },
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbjp7plrso0",
                                                                            "created": 1635475559209,
                                                                            "text": "解决的问题",
                                                                            "expandState": "collapse"
                                                                        },
                                                                        "children": [
                                                                            {
                                                                                "data": {
                                                                                    "id": "cfbjphgn4s00",
                                                                                    "created": 1635475580435,
                                                                                    "text": "远程写是异步的，本地写是同步的 \n远程写是往Store Buffer，本地写是往Cache \n实现原理：遇到写屏障把写屏障标记及之后的缓存都写入Store Buffer（即便是本地写），解除标记时全部写入Cache"
                                                                                },
                                                                                "children": []
                                                                            }
                                                                        ]
                                                                    },
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbookv0xrk0",
                                                                            "created": 1635489615020,
                                                                            "text": "把写屏障与获得ACK之间的写操作视为一个整体缓存和再刷入"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfboqzyqdj40",
                                                            "created": 1635489804625,
                                                            "text": "区别",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfbor1d40lk0",
                                                                    "created": 1635489807671,
                                                                    "text": "同步的对其他CPU而言可以更快拿到缓存更新结果，\n 异步的对当前CPU而言效率更高，但是对其他CPU而言需要晚一步"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfbjbkr11ko0",
                                                    "created": 1635474490495,
                                                    "text": "读屏障",
                                                    "expandState": "collapse"
                                                },
                                                "children": [
                                                    {
                                                        "data": {
                                                            "id": "cfbjtxq9qhs0",
                                                            "created": 1635475929302,
                                                            "text": "遇到读屏障，则将Invalid Queue中的数据全部处理完"
                                                        },
                                                        "children": []
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfbk7ndeafc0",
                                                            "created": 1635477003854,
                                                            "text": "实现读的可见性，读（远程写）的可见性",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfbk85sk5k00",
                                                                    "created": 1635477043953,
                                                                    "text": "1. 响应远程写"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfbk9dsx07c0",
                                                                    "created": 1635477139753,
                                                                    "text": "2. 远程写消息放入 Invalid Queue，待处理"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfbk7wat4lc0",
                                                                    "created": 1635477023289,
                                                                    "text": "3. 已经可以读到远程CPU（它自己本地的）缓存数据的修改"
                                                                },
                                                                "children": []
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfbkb87wf340",
                                                                    "created": 1635477284327,
                                                                    "text": "4. 想要当前CPU之前独享的缓存数据"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbkpuyr62w0",
                                                                            "created": 1635478430938,
                                                                            "text": "按道理，已经可以读到远程CPU修改过（它本地）的变量，\n那么远程CPU修改过（当前CPU）的变量应该同样可见才是，\n 因为远程CPU写屏障已经解除了（已经获取到了ACK），\n但实际当前CPU还没有处理，消息依旧在Invalid Queue中，"
                                                                        },
                                                                        "children": []
                                                                    },
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbkg7elrhs0",
                                                                            "created": 1635477674376,
                                                                            "text": "遇到读屏障，将已无效的缓存处理掉，之后不再从Cache中读，以防脏读"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            },
                                                            {
                                                                "data": {
                                                                    "id": "cfbkdtktqmo0",
                                                                    "created": 1635477487549,
                                                                    "text": "5. 远程读（之前远程写）相应的缓存行"
                                                                },
                                                                "children": [
                                                                    {
                                                                        "data": {
                                                                            "id": "cfbkgz1q5fs0",
                                                                            "created": 1635477734548,
                                                                            "text": "获取正确的缓存"
                                                                        },
                                                                        "children": []
                                                                    }
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    {
                                                        "data": {
                                                            "id": "cfbjycf5byg0",
                                                            "created": 1635476274738,
                                                            "text": "解决的问题",
                                                            "expandState": "collapse"
                                                        },
                                                        "children": [
                                                            {
                                                                "data": {
                                                                    "id": "cfbjyf2xwaw0",
                                                                    "created": 1635476280530,
                                                                    "text": "远程读是同步的，本地读是同步的，处理远程写是异步的\n 本地读直接从Cache中获取，远程写的通知消息可能还在在Invalid Queue中"
                                                                },
                                                                "children": []
                                                            }
                                                        ]
                                                    }
                                                ]
                                            },
                                            {
                                                "data": {
                                                    "id": "cfbo6jg77vc0",
                                                    "created": 1635488201392,
                                                    "text": "全屏障"
                                                },
                                                "children": []
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "data": {
                    "id": "cf996qjzel40",
                    "created": 1635242780296,
                    "text": "4. JVM内存模型"
                },
                "children": [
                    {
                        "data": {
                            "id": "cfbnxao9hq00",
                            "created": 1635487477011,
                            "text": "模型图"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfbnxlzg7jk0",
                                    "created": 1635487501632,
                                    "text": "图例"
                                },
                                "children": []
                            }
                        ]
                    }
                ]
            },
            {
                "data": {
                    "id": "cf9taejycvs0",
                    "created": 1635299489828,
                    "text": "5. JVM实现原理"
                },
                "children": []
            },
            {
                "data": {
                    "id": "cf9taphp5fc0",
                    "created": 1635299513636,
                    "text": "6. 相关实际应用",
                    "expandState": "collapse"
                },
                "children": [
                    {
                        "data": {
                            "id": "cf9tb2t1db40",
                            "created": 1635299542620,
                            "text": "1. 双重校验锁定模式 - 单例模式",
                            "expandState": "collapse"
                        },
                        "children": [
                            {
                                "data": {
                                    "id": "cfbp0gstm600",
                                    "created": 1635490546550,
                                    "text": "目的是避免指令重排：初始化对象与变量引用赋值可能颠倒。\n 避免其他线程拿到未初始化的对象进行操作"
                                },
                                "children": []
                            },
                            {
                                "data": {
                                    "id": "cfbp31z3pkg0",
                                    "created": 1635490749371,
                                    "text": "代替方案：基于内部类初始化"
                                },
                                "children": []
                            }
                        ]
                    }
                ]
            }
        ]
    },
    "template": "default",
    "theme": "fresh-blue",
    "version": "1.4.43"
}